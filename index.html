<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        .main-grid {
            display: grid;
            grid-template-columns: repeat(23, 1fr);
            gap: 0;
            width: 100%;
            max-width: 100vw;
            margin-bottom: 20px;
        }

        .block {
            position: relative;
            aspect-ratio: 1;
            box-sizing: border-box;
            border: 1px solid #999;
            grid-column: span 2;
            grid-row: span 2;
        }

        .inner-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            height: 100%;
        }

        .cell {
            aspect-ratio: 1;
            background: #fff;
        }

        .label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2vw;
            pointer-events: none;
        }

        .fortress {
            border: 2px solid red;
        }

        .fortress .label {
            color: red;
            font-weight: bold;
            font-size: 1vw;
        }

        #spreadsheet {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            padding: 10px;
        }

        .spreadsheet-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .spreadsheet-item input {
            width: 60px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="main-grid"></div>
    <div id="spreadsheet"></div>

    <script>
        // Create grid blocks
        const gridSize = 23;
        const blocksPerRow = Math.floor(gridSize/2);
        let blockNumber = 1;
        let fortressPosition = Math.floor(blocksPerRow/2);

        for(let row = 0; row < blocksPerRow; row++) {
            for(let col = 0; col < blocksPerRow; col++) {
                const block = document.createElement('div');
                block.className = 'block' + (row === fortressPosition && col === fortressPosition ? ' fortress' : '');
                
                // Create inner 2x2 grid
                const innerGrid = document.createElement('div');
                innerGrid.className = 'inner-grid';
                for(let i = 0; i < 4; i++) {
                    innerGrid.appendChild(document.createElement('div')).className = 'cell';
                }
                
                // Add label
                const label = document.createElement('div');
                label.className = 'label';
                label.textContent = (row === fortressPosition && col === fortressPosition) ? 'Fortress' : blockNumber;
                
                block.appendChild(innerGrid);
                block.appendChild(label);
                document.querySelector('.main-grid').appendChild(block);

                if(!(row === fortressPosition && col === fortressPosition)) blockNumber++;
            }
        }

        // Create spreadsheet
        let spreadsheetNumber = 1;
        for(let row = 0; row < blocksPerRow; row++) {
            for(let col = 0; col < blocksPerRow; col++) {
                if(row === fortressPosition && col === fortressPosition) continue;
                
                const item = document.createElement('div');
                item.className = 'spreadsheet-item';
                item.innerHTML = `
                    <span>${spreadsheetNumber}:</span>
                    <input type="text" value="${spreadsheetNumber}">
                `;
                
                // Add event listener
                item.querySelector('input').addEventListener('input', (e) => {
                    const labels = document.querySelectorAll('.label:not(.fortress .label)');
                    labels[spreadsheetNumber - 1].textContent = e.target.value;
                });
                
                document.getElementById('spreadsheet').appendChild(item);
                spreadsheetNumber++;
            }
        }
    </script>
</body>
</html>
